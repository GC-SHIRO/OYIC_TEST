<!-- 预览角色卡页面 -->
<view class="page-container">
  <!-- 顶部导航 -->
  <view class="navbar">
    <view class="nav-back" bindtap="onBack">
      <t-icon name="chevron-left" size="40rpx" color="#374151" />
    </view>
    <text class="navbar-title">预览角色卡</text>
    <view class="nav-placeholder"></view>
  </view>
  
  <!-- 内容区域 -->
  <scroll-view class="content-container" scroll-y enhanced show-scrollbar="{{false}}">
    <!-- 加载中 -->
    <view wx:if="{{loading}}" class="loading-container">
      <t-loading theme="circular" size="80rpx" />
      <text class="loading-text">正在生成角色卡...</text>
    </view>
    
    <block wx:else>
      <!-- 角色卡片预览 -->
      <view class="character-preview">
        <!-- 头部：姓名 -->
        <view class="preview-header">
          <view class="character-name">{{character.name}}</view>
          <view class="character-intro">{{character.introduction}}</view>
        </view>
        
        <view class="preview-body">
          <!-- 基本信息 -->
          <view class="info-section">
            <view class="section-title">基本信息</view>
            <view class="section-content">
              <view class="info-item">
                <text class="info-label">姓名：</text>
                <text class="info-value">{{character.name}}</text>
              </view>
              <view class="info-item">
                <text class="info-label">性别：</text>
                <text class="info-value">{{character.gender}}</text>
              </view>
              <view class="info-item">
                <text class="info-label">星座：</text>
                <text class="info-value">{{character.constellation}}</text>
              </view>
              <view class="info-item">
                <text class="info-label">生日：</text>
                <text class="info-value">{{character.birthday}}</text>
              </view>
              <view class="info-item">
                <text class="info-label">物种：</text>
                <text class="info-value">{{character.species}}</text>
              </view>
            </view>
          </view>
          
          <view class="section-divider"></view>
          
          <!-- 性格标签 -->
          <view class="info-section">
            <view class="section-title">性格标签</view>
            <view class="personality-tags">
              <view 
                wx:for="{{character.personalityTags}}" 
                wx:key="*this"
                class="personality-tag"
              >
                {{item}}
              </view>
            </view>
          </view>
          
          <view class="section-divider"></view>
          
          <!-- 外观描述 -->
          <view class="info-section">
            <view class="section-title">外观描述</view>
            <view class="appearance-attrs">
              <view class="appearance-attr">
                <view class="attr-color-dot hair-dot"></view>
                <text class="attr-label">发色</text>
                <text class="attr-value">{{character.appearance.hairColor}}</text>
              </view>
              <view class="appearance-attr">
                <view class="attr-color-dot eye-dot"></view>
                <text class="attr-label">瞳色</text>
                <text class="attr-value">{{character.appearance.eyeColor}}</text>
              </view>
            </view>
            <view class="appearance-detail-wrap">
              <text class="appearance-detail">{{character.appearance.detail}}</text>
            </view>
          </view>
          
          <view class="section-divider"></view>
          
          <!-- 性格描述 -->
          <view class="info-section">
            <view class="section-title">性格描述</view>
            <view class="section-content">
              <text class="long-text">{{character.personality}}</text>
            </view>
          </view>
          
          <view class="section-divider"></view>
          
          <!-- 角色背景 -->
          <view class="info-section">
            <view class="section-title">角色背景</view>
            <view class="section-content">
              <text class="long-text">{{character.backstory}}</text>
            </view>
          </view>
          
          <!-- 故事线（可选） -->
          <block wx:if="{{character.storyline}}">
            <view class="section-divider"></view>
            <view class="info-section">
              <view class="section-title">故事线</view>
              <view class="section-content">
                <text class="long-text">{{character.storyline}}</text>
              </view>
            </view>
          </block>
          
          <!-- 特殊能力（可选） -->
          <block wx:if="{{character.abilities.length > 0}}">
            <view class="section-divider"></view>
            <view class="info-section">
              <view class="section-title">特殊能力</view>
              <view class="ability-list">
                <view 
                  wx:for="{{character.abilities}}" 
                  wx:key="name"
                  class="ability-item"
                >
                  <text class="ability-name">{{item.name}}</text>
                  <text class="ability-desc">{{item.description}}</text>
                </view>
              </view>
            </view>
          </block>
          
          <!-- 关系网（可选） -->
          <block wx:if="{{character.relationships.length > 0}}">
            <view class="section-divider"></view>
            <view class="info-section">
              <view class="section-title">关系网</view>
              <view class="relationship-list">
                <view 
                  wx:for="{{character.relationships}}" 
                  wx:key="character"
                  class="relationship-item"
                >
                  <text class="rel-character">{{item.character}}</text>
                  <text class="rel-arrow">→</text>
                  <text class="rel-desc">{{item.relation}}</text>
                </view>
              </view>
            </view>
          </block>
          
          <!-- 性格六维图 -->
          <block wx:if="{{character.radar}}">
            <view class="section-divider"></view>
            <view class="info-section">
              <view class="section-title">性格六维图</view>
              <view class="radar-section">
                <canvas type="2d" id="radarCanvas" class="radar-canvas"></canvas>
                <view class="radar-legends">
                  <view class="radar-legend-item">
                    <text class="legend-label">外向度</text>
                    <text class="legend-value">{{character.radar.extroversion}}</text>
                  </view>
                  <view class="radar-legend-item">
                    <text class="legend-label">理智度</text>
                    <text class="legend-value">{{character.radar.rationality}}</text>
                  </view>
                  <view class="radar-legend-item">
                    <text class="legend-label">善良度</text>
                    <text class="legend-value">{{character.radar.kindness}}</text>
                  </view>
                  <view class="radar-legend-item">
                    <text class="legend-label">胆识度</text>
                    <text class="legend-value">{{character.radar.courage}}</text>
                  </view>
                  <view class="radar-legend-item">
                    <text class="legend-label">开放度</text>
                    <text class="legend-value">{{character.radar.openness}}</text>
                  </view>
                  <view class="radar-legend-item">
                    <text class="legend-label">责任感</text>
                    <text class="legend-value">{{character.radar.responsibility}}</text>
                  </view>
                </view>
              </view>
            </view>
          </block>
        </view>
      </view>
    </block>
    
    <!-- 底部占位 -->
    <view class="bottom-placeholder"></view>
  </scroll-view>
  
  <!-- 底部操作栏 -->
  <view class="action-bar" wx:if="{{!loading && !readonly}}">
    <t-button 
      class="btn-secondary" 
      theme="light" 
      size="large"
      bindtap="onContinue"
    >
      继续创作
    </t-button>
    <t-button 
      class="btn-primary" 
      theme="primary" 
      size="large"
      bindtap="onComplete"
    >
      完成创建
    </t-button>
  </view>
</view>
