<!-- é¦–é¡µ - å¤šåŠŸèƒ½ä¸»é¡µ -->
<view class="page-container {{isDeleteMode ? 'delete-mode' : ''}} {{isExitAnimating ? 'delete-exit' : ''}}">
  <!-- é¡¶éƒ¨æ ‡é¢˜ -->
  <view class="navbar">
    <text class="navbar-title">é¦–é¡µ</text>
  </view>
  
  <!-- é¡µé¢ä¸»ä½“ï¼ˆä¸Šä¸‹ä¸¤éƒ¨åˆ†ï¼‰ -->
  <scroll-view class="main-scroll" scroll-y enable-flex enhanced show-scrollbar="{{false}}">
    <!-- ============ ä¸ŠåŠéƒ¨åˆ†ï¼šè§’è‰²å¡åŒº ============ -->
    <view class="section-characters">
      <view class="section-header">
        <text class="section-title">æˆ‘çš„è§’è‰²</text>
        <view wx:if="{{loading}}" class="loading-hint">
          <t-loading size="16px" />
          <text style="margin-left: 8rpx; font-size: 24rpx; color: #6b7280;">åŒæ­¥ä¸­...</text>
        </view>
      </view>

      <view class="cards-container">
        <scroll-view 
          class="cards-scroll" 
          scroll-x 
          enable-flex
          enhanced 
          show-scrollbar="{{false}}"
          scroll-left="{{scrollLeft}}"
        >
          <!-- æ–°å»ºè§’è‰²å¡ç‰‡ -->
          <view class="character-card card-new" bindtap="onCreateCharacter">
            <view class="new-icon">
              <t-icon name="add" size="80px" color="#334155" />
            </view>
          </view>
          
          <!-- æœªå®Œæˆçš„è§’è‰²å¡ç‰‡ -->
          <view 
            class="character-card card-incomplete" 
            wx:for="{{incompleteCharacters}}" 
            wx:key="id"
            bindtap="onCardTap"
            bindlongpress="onCardLongPress"
            data-id="{{item.id}}"
            data-status="incomplete"
          >
            <view wx:if="{{isDeleteMode}}" class="delete-btn" bindtap="onDeleteTap" data-id="{{item.id}}">
              <text class="delete-icon">Ã—</text>
            </view>
            <image 
              src="{{item.avatar}}" 
              class="card-image" 
              mode="aspectFill"
            />
            <view class="card-info">
              <view class="card-name">{{item.name}}</view>
              <view class="card-desc">{{item.introduction}}</view>
            </view>
            <view class="card-blur-overlay">
              <view class="incomplete-label">æœªå®Œæˆ</view>
            </view>
          </view>
          
          <!-- å·²å®Œæˆçš„è§’è‰²å¡ç‰‡ -->
          <view 
            class="character-card card-completed" 
            wx:for="{{completedCharacters}}" 
            wx:key="id"
            bindtap="onCardTap"
            bindlongpress="onCardLongPress"
            data-id="{{item.id}}"
            data-status="completed"
          >
            <view wx:if="{{isDeleteMode}}" class="delete-btn" bindtap="onDeleteTap" data-id="{{item.id}}">
              <text class="delete-icon">Ã—</text>
            </view>
            <image 
              src="{{item.avatar}}" 
              class="card-image" 
              mode="aspectFill"
            />
            <view class="card-info">
              <view class="card-name">{{item.name}}</view>
              <view class="card-desc">{{item.introduction}}</view>
              <t-tag class="card-tag" variant="light" theme="primary">å·²å®Œæˆ</t-tag>
            </view>
          </view>
        </scroll-view>
      </view>
    </view>

    <!-- ============ ä¸‹åŠéƒ¨åˆ†ï¼šæ´»åŠ¨/å…¬å‘Š/å¹¿å‘ŠåŒº ============ -->
    <view class="section-feed">
      <view class="section-header">
        <text class="section-title">æœ€æ–°èµ„è®¯</text>
        <view wx:if="{{feedLoading}}" class="loading-hint">
          <t-loading size="16px" />
        </view>
      </view>

      <view class="feed-list">
        <view 
          class="feed-item {{item.type}}"
          wx:for="{{feedItems}}"
          wx:key="id"
          bindtap="onFeedItemTap"
          data-actionUrl="{{item.actionUrl}}"
        >
          <view class="feed-badge" style="background-color: {{item.tagColor || '#4ECDC4'}}">
            {{item.badgeText}}
          </view>
          <view class="feed-content">
            <view class="feed-title">{{item.title}}</view>
            <view class="feed-desc">{{item.description}}</view>
          </view>
          <view class="feed-arrow">
            <t-icon name="chevron-right" size="20px" color="#cbd5e1" />
          </view>
        </view>
      </view>

      <!-- æ— å†…å®¹æç¤º -->
      <view wx:if="{{feedItems.length === 0 && !feedLoading}}" class="empty-state">
        <view class="empty-icon">ğŸ“¢</view>
        <text class="empty-text">æš‚æ— èµ„è®¯</text>
      </view>
    </view>

    <!-- åº•éƒ¨å®‰å…¨è·ç¦» -->
    <view style="height: 40rpx;"></view>
  </scroll-view>

  <view wx:if="{{isDeleteMode}}" class="exit-edit-fab" bindtap="onExitDeleteMode">
    é€€å‡ºç¼–è¾‘
  </view>
</view>
